# 简介

我们知道`IOC控制反转`是进行系统解耦行之有效的架构设计，也是应对大型业务系统开发的支撑工具

## 状态共享机制

在实际开发当中，会遇到三个场景的状态共享：`组件内部状态共享`、`组件之间状态共享`、`全局状态共享`。在传统的Vue3当中，分别采用不同的机制来实现，而在Zova中只需要采用统一的IOC容器机制

| 场景             | 传统的Vue3     | Zova |
| ---------------- | -------------- | ---- |
| 组件内部状态共享 | Composable     | IOC  |
| 组件之间状态共享 | Provide/Inject | IOC  |
| 全局状态共享     | Pinia          | IOC  |

## IOC容器

在Zova中有两类ioc容器:

1. `全局ioc容器`(简称为app容器)：在系统初始化时，会自动创建唯一一个全局ioc容器。在这个容器中创建的Bean实例都是单例模式
2. `组件实例ioc容器`(简称为ctx容器)：在创建Vue组件实例时，系统会为每一个Vue组件实例创建一个ioc容器。在这个容器中创建的Bean实例可以在组件实例范围之内共享数据和逻辑

## Bean Class

Zova采用模块化体系，Bean Class都由不同的模块提供。注入模块内部的Bean时可以直接基于`Class类型`解析。在跨模块注入时可以基于`Bean标识`解析，而不是基于`Class类型/文件路径`解析，这样有利于实现模块之间的松耦合

因此，Zova提供了两类Bean Class：

1. `匿名bean`：使用`@Local`装饰的class就是`匿名bean`。此类bean仅在模块内部使用，不存在命名冲突的问题，定义和使用都很便捷
2. `具名bean`：除了`@Local`之外，其他装饰器函数装饰的class都是`具名bean`。Zova为此类bean提供了统一的命名规范，并且分配了唯一的`Bean标识`，既可以避免命名冲突，也有利于跨模块使用

## 注入范围

Zova提供了以下几种注入范围：

1. `app`：在app容器中注入
2. `ctx`：在ctx容器中注入
3. `new`：总是创建一个新的bean实例

## 层级注入

注入范围还支持层级注入：

1. `host`：在当前组件实例的ioc容器以及所有父容器中依次查找并注入bean实例
2. `skipSelf`：在所有父容器中依次查找并注入bean实例
